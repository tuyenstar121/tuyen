<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>

<HEAD>
  <link rel='shortcut icon' href='image/png-clipart-bulldog-shar-pei-mammal-carnivoran.png' />
  <TITLE> KhaLaNa</TITLE>
  <META NAME="Generator" CONTENT="EditPlus">
  <META NAME="Author" CONTENT="">
  <META NAME="Keywords" CONTENT="">
  <META NAME="Description" CONTENT="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" />
  <link rel="stylesheet" href="tinyPlayer.css" />
  <script src="https://kit.fontawesome.com/b8b432d7d3.js" crossorigin="anonymous"></script>
  <style>
    @import url('https://fonts.googleapis.com/css?family=Baloo+Thambi');

    * {
      padding: 0;
      margin: 0;
      box-sizing: border-box;

    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;

      z-index: 0;

      background-image: url(image/nature-3082832_1920.jpg);

      background-size: cover;
      background-blend-mode: soft-light;


      background-color: #28252c;


    }


    canvas {
      position: absolute;
      width: 80%;
      height: 80%;
      z-index: 10;
      left: 10px;
      top: 0px;



    }

    .audio {
      width: 80%;
      position: absolute;
      top: 70%;
      height: 20%;
      z-index: 100;
    }

    .box {
      position: absolute;
      width: 500px;
      height: 700px;
      border-radius: 15px;
      overflow: hidden;
      background-color: #0d0d0e;

      display: flex;
      justify-content: center;
      align-items: center;



    }

    .box::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;

      width: 500px;
      height: 700px;
      background: linear-gradient(0deg, transparent, #45f3ff, #45f3ff);
      animation: animate 6s linear infinite;
      transform-origin: bottom right;

    }

    .box::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;

      width: 500px;
      height: 700px;
      background: linear-gradient(0deg, transparent, #45f3ff, #45f3ff);
      animation: animate 6s linear infinite;
      transform-origin: bottom right;
      animation-delay: -3s;

    }

   

    .social-media {
      position: static;
      grid-area: 2/1/3/3;

      text-align: center;
      background-color: var(--secondary-bg);
      color: var(--secondary-color);
      padding: 8px;
      border-radius: 15px;

      display: flex;
      align-items: center;
      gap: 20px;
    }


    ul {
      display: flex;
    }

    ul li {
      position: relative;
      display: block;
      color: #666;
      font-size: 15px;
      height: 30px;
      width: 30px;
      background: #171515;
      line-height: 30px;
      border-radius: 50%;
      margin: 0 15px;
      cursor: pointer;
      transition: .5s;
    }

    ul li:before {
      position: absolute;
      content: '';
      top: 0;
      left: 0;
      height: inherit;
      width: inherit;
      /* background: #d35400; */
      border-radius: 50%;
      transform: scale(.9);
      z-index: -1;
      transition: .5s;
    }

    ul li:nth-child(1):before {
      background: #4267B2;
    }

    ul li:nth-child(2):before {
      background: #1DA1F2;
    }

    ul li:nth-child(3):before {
      background: #E1306C;
    }

    ul li:nth-child(4):before {
      background: #2867B2;
    }

    ul li:nth-child(5):before {
      background: #ff0000;
    }

    ul li:hover:before {
      filter: blur(3px);
      transform: scale(1.4);
      /* box-shadow: 0 0 15px #d35400; */
    }

    ul li:nth-child(1):hover:before {
      box-shadow: 0 0 15px #4267B2;
    }

    ul li:nth-child(2):hover:before {
      box-shadow: 0 0 15px #1DA1F2;
    }

    ul li:nth-child(3):hover:before {
      box-shadow: 0 0 15px #E1306C;
    }

    ul li:nth-child(4):hover:before {
      box-shadow: 0 0 15px #2867B2;
    }

    ul li:nth-child(5):hover:before {
      box-shadow: 0 0 15px #ff0000;
    }

    ul li:nth-child(1):hover {
      color: #456cba;
      box-shadow: 0 0 15px #4267B2;
      text-shadow: 0 0 15px #4267B2;
    }

    ul li:nth-child(2):hover {
      color: #26a4f2;
      box-shadow: 0 0 15px #1DA1F2;
      text-shadow: 0 0 15px #1DA1F2;
    }

    #b:hover {
      color: #e23670;
      box-shadow: 0 0 15px #E1306C;
      text-shadow: 0 0 15px #E1306C;
    }

    ul li:nth-child(4):hover {
      color: #2a6cbb;
      box-shadow: 0 0 15px #2867B2;
      text-shadow: 0 0 15px #2867B2;
    }

    ul li:nth-child(5):hover {
      color: #ff1a1a;
      box-shadow: 0 0 15px #ff0000;
      text-shadow: 0 0 15px #ff0000;
    }

    ul li:hover {
      color: #ffa502;
      box-shadow: 0 0 15px #d35400;
      text-shadow: 0 0 15px #d35400;
    }

    ul li i {
      margin-top: 8;
    }


    #pinkboard {
      position: relative;
      margin: auto;
      height: 400px;
      width: 400px;
      animation: animate1 2s infinite;
    }

    #pinkboard:before,
    #pinkboard:after {
      content: '';
      position: absolute;
      background: #FF5CA4;
      width: 100px;
      height: 160px;
      border-top-left-radius: 50px;
      border-top-right-radius: 50px;
    }

    #pinkboard:before {
      left: 100px;
      transform: rotate(-45deg);
      transform-origin: 0 100%;
      box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
        0 10px 10px rgba(0, 0, 0, 0.22);
    }

    #pinkboard:after {
      left: 0;
      transform: rotate(45deg);
      transform-origin: 100% 100%;
    }

    span {
      position: static;
      size: 1000px;
      top: 100;
      ;
    }

    .test {


      position: absolute;
      color: #111;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
     
      left: 2%;
    top: 25%;
      font-family: 'Baloo Thambi', cursive;
      font-size: 4rem;


    }

    .test>span {
      animation: glow 2s ease-in-out infinite;
    }

    .test>span:nth-child(1) {
      animation-delay: 0, 25s;
    }

    .test>span:nth-child(2) {
      animation-delay: 0.5s;
    }

    .test>span:nth-child(3) {
      animation-delay: 0.75s;
    }

    .test>span:nth-child(4) {
      animation-delay: 1s;
    }

    .test>span:nth-child(5) {
      animation-delay: 1.25s;
    }

    .test>span:nth-child(6) {
      animation-delay: 1.5s;
    }

    .test>span:nth-child(7) {
      animation-delay: 1.75s;
    }

    @keyframes glow {

      0%,
      100% {
        color:
          #fff;
        text-shadow: 0 0 12px lime, 0 0 50px lime, 0 0 100px lime;
      }

      10%,
      90% {
        color: #111;
        text-shadow: none;
      }
    }

    @keyframes animate1 {
      0% {
        transform: scale(1);
      }

      30% {
        transform: scale(.8);
      }

      60% {
        transform: scale(1.2);
      }

      100% {
        transform: scale(1);
      }
    }

    /* 
    @media only screen and (max-width:1024px) {
      .box {
        position: absolute;
        width: 800px;
        height: 900px;
        border-radius: 12px;
        overflow: hidden;

        background-color: #070707;




      }

      .box::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;

        width: 800px;
        height: 900px;
        background: linear-gradient(0deg, transparent, #45f3ff, #45f3ff);
        animation: animate 6s linear infinite;
        transform-origin: bottom right;
      }

      .box::after {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;

        width: 800px;
        height: 900px;
        background: linear-gradient(0deg, transparent, #45f3ff, #45f3ff);
        animation: animate 6s linear infinite;
        transform-origin: bottom right;
        animation-delay: -3s;

      }

      .form {
        position: absolute;
        inset: 3px;
        border-radius: 8px;
        background: #28292d;
        z-index: 1;
        padding: 50px;
        background-image: url("image/a.jpg");
        background-repeat: no-repeat;

        background-size: 100%;
      }

      .body {
        display: block;
        justify-content: center;
        align-items: center;
        min-height: 10vh;
        min-width: 60%;
        background-image: url(image/images.jfif);
        background-repeat: repeat;
        z-index: 0;
        background-color: #050505;
      }

      .audio {
        position: relative;
        top: 75%;
        height: 30%;
        width: 100%;
        z-index: 30;
      
      }

   
    } */

    @keyframes animate {
      0% {
        transform: rotate(0deg);

      }

      100% {
        transform: rotate(360deg);
      }
    }


    ;
  </style>
</HEAD>

<BODY>

  <div class="box">

    <div class="form">
      <div class="test">
        <span>K</span>
        <span>H</span>
        <span>A</span>
        <span>L</span>
        <span>A</span>
        <span>N</span>
        <span>A </span>



      </div>
   

      <div class="audio">

        <div class="wrapper">

          <!-- 1. length of song not updating - something with const duration-->
          <div class="music-container" id="music-container">
            <div class="music-info">
              <h4 id="title"></h4>

              <div class="progress-container progress-range" id="progress-container">
                <div class="progress progress-bar" id="progress"></div>
              </div>
            </div>
            <div class="social-media">
              <ul>
                <a href="https://www.facebook.com/phuongnhi.dang.965">
                  <li id="a"><i class="fab fa-facebook-f"></i></li>
                </a>
                <a href="">
                  <li><i class="fab fa-twitter"></i></li>
                </a>
                <a href="https://www.instagram.com/khalana_n/?hl=en">
                  <li id="b"><i class="fab fa-instagram"></i></li>
                </a>
                <li><i class="fab fa-linkedin-in"></i></li>
                <li><i class="fab fa-youtube"></i></li>
              </ul>
            </div>

            <audio src="image/NgheNhuTinhYeu-HIEUTHUHAI-7045493.mp3" id="audio" class="audio audio_player"
              preload="metadata"></audio>

            <div class="navigation">
              <button id="prev" class="action-btn" title="Previous">
                <i class="fas fa-backward"></i>
              </button>
              <button id="play" class="action-btn action-btn-big">
                <i class="fas fa-play"></i>
              </button>
              <button id="next" class="action-btn" title="Next">
                <i class="fas fa-forward"></i>
              </button>

              <button class="action-btn speaker">
                <i id="speaker_icon" class="fa fa-volume-up" aria-hidden="true"></i>
              </button>
              <input type="range" name="volume" class="player_slider" min="0" max="1" step="0.05" value="1"></input>

              <div class="time">
                <span class="time-elapsed">00:00</span>
                <span class="time-duration"> / 5:59</span>
              </div>
            </div>


          </div>
        </div>

      </div>

    </div>

  </div>

  
  <script>
    const musicContainer = document.getElementById('music-container');
    const audioPlayer = musicContainer.querySelector('.audio_player');

    const title = document.getElementById('title');
    // 
    const progressRange = document.querySelector('.progress-range');
    const progressBar = document.querySelector('.progress-bar');
    // 
    // const progressContainer = document.getElementById('progress-container');
    // const progress = document.getElementById('progress');

    const currentTime = document.querySelector('.time-elapsed');
    const duration = document.querySelector('.time-duration');

    const audio = document.getElementById('audio');

    const prevBtn = document.getElementById('prev');
    const playBtn = document.getElementById('play');
    const nextBtn = document.getElementById('next');

    const speaker = musicContainer.querySelector('.speaker');
    const speakerIcon = musicContainer.querySelector('#speaker_icon');

    const ranges = musicContainer.querySelectorAll('.player_slider');
    const volInput = musicContainer.querySelector('input[name="volume"]')

    // const cover = document.getElementById('cover');

    // Song Titles - need to get rid of this hard coded list of titles. Need to be able to upload multiple files from desktop or load a list from an API
    const songs = [
    'Đặng Thị Phương Nhi',

    ];

    // Keep track of song
    let songIndex = 0;

    // initially load song details into DOM
    loadSong(songs[songIndex]);

    function loadSong(song) {
      title.innerText = song;
      // audio.src = `music/${song}.mp3`;
      // need an array of songs, either on the user's harddrive or another website
      //audio.src = `https://raw.githubusercontent.com/himalayasingh/music-player-1/master/music/4.mp3`;
      // cover.src = `images/${song}.jpg`;
    }

    // remove Play icon, add Pause icon 
    function playSong() {
      musicContainer.classList.add('play');
      playBtn.querySelector('i.fas').classList.remove('fa-play');
      playBtn.querySelector('i.fas').classList.add('fa-pause');

      audio.play();
    }

    // remove Pause icon, add Play icon
    // why aren't these combined into a play\pause toggle function?
    function pauseSong() {
      musicContainer.classList.remove('play');
      playBtn.querySelector('i.fas').classList.add('fa-play');
      playBtn.querySelector('i.fas').classList.remove('fa-pause');

      audio.pause();
    }

    // previous song
    function prevSong() {
      songIndex--;

      if (songIndex < 0) {
        songIndex = songs.length - 1;
      }

      loadSong(songs[songIndex]);


    }

    // next song
    function nextSong() {
      songIndex++;

      if (songIndex > songs.length - 1) {
        songIndex = 0;
      }

      loadSong(songs[songIndex]);


    }

    // update progress bar
    // function updateProgress(e) {
    //   const { duration, currentTime } = e.srcElement;
    //   const progressPercent = (currentTime / duration) * 100;
    //   progress.style.width = `${progressPercent}%`;
    //   console.log('Working');
    // }

    /* updateProgress - the above one stops progress, the one below works but get NaN */


    // VIDEO - - - - - - -Calculate display time format
    // IT'S THIS FUNCTION, THE SECONDS

    function displayTime(time) {
      const minutes = Math.floor(time / 60);
      let seconds = Math.floor(time % 60);
      seconds = seconds > 9 ? seconds : `0${seconds}`;
      return `${minutes}:${seconds}`;
      // return minutes + ':' + seconds;
    }

    // VIDEO - - - - - - - update progress bar as the video plays
    // OR THIS FUNCTION, DURATION IS A PROPERTY OF THE VIDEO ELEMENT, WHAT ABOUT THE AUDIO ELEMENT? ad to comment out time-duration in index.html

    function updateProgress() {
      //   added this to stop the NaN displaying, seems to work
      let duration = 0;
      progressBar.style.width = `${(audioPlayer.currentTime / audioPlayer.duration) * 100}%`;
      currentTime.textContent = `${displayTime(audioPlayer.currentTime)} /`;
      // currentTime.textContent = `${displayTime(audioPlayer.currentTime)}`;
      duration.textContent =
        // had to comment out the duration   
        `${displayTime(audioPlayer.duration)}`;
    }
    // VIDEO - - - - -
    function scrub(event) {
      const scrubTime = (event.offsetX / progressRange.offsetWidth) * audioPlayer.duration;
      audioPlayer.currentTime = scrubTime;
    }

    // from https://css-tricks.com/lets-create-a-custom-audio-player/ but only got rid of the initial load - search: html5 audio element duration NaN
    const displayDuration = () => {
      duration.textContent = displayTime(audio.duration);
    }

    if (audio.readyState > 0) {
      displayDuration();
    } else {
      audio.addEventListener('loadedmetadata', () => {
        displayDuration();
      });
    }

    // set progress bar
    // function setProgress(e) {
    //   const width = this.clientWidth;
    //   const clickX = e.offsetX;
    //   const duration = audio.duration;

    //   audio.currentTime = (clickX / width) * duration;
    // }
    // VIDEO - - - - - Click to seek within the video
    function setProgress(e) {
      const newTime = e.offsetX / progressRange.offsetWidth;
      progressBar.style.width = `${newTime * 100}%`;
      audioPlayer.currentTime = newTime * audioPlayer.duration;
    }

    // ==================== VOLUME CONTROLS

    // volume functions
    function handleRangeUpdate() {
      audioPlayer[this.name] = this.value;
      (audioPlayer['volume'] === 0 ? speakerIcon.className = "fa fa-volume-off" :
        speakerIcon.className = "fa fa-volume-up")
    }

    let muted = false;

    // need to have the muste button return to previous setting, not back to full
    function mute() {
      if (!muted) {
        audioPlayer['volume'] = 0;
        volInput.value = 0;
        speakerIcon.className = "fa fa-volume-off"
        muted = true;
      } else {
        audioPlayer['volume'] = 1;
        volInput.value = 1;
        muted = false;
        speakerIcon.className = "fa fa-volume-up"
      }
    }

    // ==================== END VOLUME CONTROLS

    // Event Listeners
    playBtn.addEventListener('click', () => {
      const isPlaying = musicContainer.classList.contains('play');

      if (isPlaying) {
        pauseSong();
      } else {
        
        playSong();
        setInterval(nextSong, 4000);
      }
    });

    // Change Song
    
    prevBtn.addEventListener('click', prevSong);
    nextBtn.addEventListener('click', nextSong);

    // time and song update
    audio.addEventListener('timeupdate', updateProgress);

    // click on progrss bar
    // progressContainer.addEventListener('click', setProgress);
    // VIDEO
    progressRange.addEventListener('click', setProgress);

    // preload metadata


    // song ends
    audio.addEventListener('ended', nextSong);

    // volume
    ranges.forEach(range => range.addEventListener('change', handleRangeUpdate));
    ranges.forEach(range => range.addEventListener('mousemove', handleRangeUpdate));
    speaker.addEventListener('click', mute)

    // progress bar controls
    let mouseDown = false;
    progressRange.addEventListener('click', scrub);
    progressRange.addEventListener('mousemove', (event) => mouseDown && scrub(event));
    progressRange.addEventListener('mousedown', () => mouseDown = true);
    progressRange.addEventListener('mouseup', () => mouseDown = false);

// ignore the massive amount of lines commented out - will fix later
// the song titles refer to the songs on my computer - you could hard code the title if the HTML if you only intend to use this for one song
// I can't figure out how to get rid of Nan for the duration element
  </script>

</BODY>

</HTML>
